<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Mini Golf Game</title>
    <link rel="stylesheet" href="game.css" />
  </head>
  <body>
    <div class="game-container">
      <h2 class="game-title">Play Mini Golf with Putty & Win 10% Off</h2>
      <p class="game-subtitle">Sink the shot. Win the reward.</p>

      <div class="game-canvas-container">
        <!-- Canvas -->
        <canvas
          id="golfPreview"
          width="700"
          height="120"
          class="game-canvas"
        ></canvas>

        <!-- Putty image -->
        <img
          src="https://cdn.shopify.com/s/files/1/1234/5678/files/putty-transparent.png"
          alt="Putty"
          class="putty-character"
        />
      </div>
    </div>
    <script>
// Mini Golf Game Logic
class MiniGolfGame {
  constructor(canvasId) {
    this.canvas = document.getElementById(canvasId);
    this.ctx = this.canvas.getContext("2d");
    this.ballPosition = { x: 100, y: 60 };
    this.holePosition = { x: 620, y: 60 };
    this.isAnimating = false;

    this.init();
  }

  init() {
    this.drawGame();
    this.setupEventListeners();
  }

  drawGame() {
    // Clear canvas
    this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);

    // Draw green lane
    this.ctx.fillStyle = "#02210A";
    this.ctx.strokeStyle = "#000";
    this.ctx.lineWidth = 4;
    this.ctx.fillRect(70, 45, 560, 30);
    this.ctx.strokeRect(70, 45, 560, 30);

    // Draw hole
    this.ctx.beginPath();
    this.ctx.arc(this.holePosition.x, this.holePosition.y, 6, 0, Math.PI * 2);
    this.ctx.fillStyle = "#000";
    this.ctx.fill();

    // Draw flag
    this.ctx.beginPath();
    this.ctx.moveTo(this.holePosition.x, this.holePosition.y);
    this.ctx.lineTo(this.holePosition.x, 30);
    this.ctx.strokeStyle = "#000";
    this.ctx.lineWidth = 2;
    this.ctx.stroke();

    this.ctx.fillStyle = "#EC3C28";
    this.ctx.beginPath();
    this.ctx.moveTo(this.holePosition.x, 30);
    this.ctx.lineTo(this.holePosition.x + 20, 35);
    this.ctx.lineTo(this.holePosition.x, 40);
    this.ctx.closePath();
    this.ctx.fill();

    // Draw ball
    this.ctx.beginPath();
    this.ctx.arc(this.ballPosition.x, this.ballPosition.y, 6, 0, 2 * Math.PI);
    this.ctx.fillStyle = "#fff";
    this.ctx.fill();
    this.ctx.strokeStyle = "#ccc";
    this.ctx.lineWidth = 1;
    this.ctx.stroke();
  }

  setupEventListeners() {
    this.canvas.addEventListener("click", (e) => {
      if (!this.isAnimating) {
        this.shootBall();
      }
    });
  }

  shootBall() {
    if (this.isAnimating) return;

    this.isAnimating = true;
    const startX = this.ballPosition.x;
    const targetX = this.holePosition.x - 6; // Stop just before the hole
    const duration = 1000; // 1 second animation
    const startTime = Date.now();

    const animate = () => {
      const elapsed = Date.now() - startTime;
      const progress = Math.min(elapsed / duration, 1);

      // Easing function for more realistic movement
      const easeOut = 1 - Math.pow(1 - progress, 3);

      this.ballPosition.x = startX + (targetX - startX) * easeOut;
      this.drawGame();

      if (progress < 1) {
        requestAnimationFrame(animate);
      } else {
        this.isAnimating = false;
        this.checkWin();
      }
    };

    animate();
  }

  checkWin() {
    const distance = Math.abs(this.ballPosition.x - this.holePosition.x);
    if (distance <= 12) {
      this.showWinMessage();
    }
  }

  showWinMessage() {
    // This could trigger a Shopify discount code or other reward
    alert("ðŸŽ‰ Hole in one! You've won 10% off your order!");

    // Reset the game
    setTimeout(() => {
      this.ballPosition.x = 100;
      this.drawGame();
    }, 2000);
  }
}

// Initialize the game when the DOM is loaded
document.addEventListener("DOMContentLoaded", function () {
  new MiniGolfGame("golfPreview");
});

</script>
  </body>
</html>
